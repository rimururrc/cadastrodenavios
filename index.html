<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Cadastro de Navios</title>
  <style>
    body {
      background-color: #121212;
      color: #ffffff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 30px;
      max-width: 800px;
      margin: auto;
    }

    h2 {
      color: #00ffcc;
      text-align: center;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 30px;
    }

    input,
    select,
    textarea,
    button {
      padding: 12px;
      border-radius: 6px;
      border: none;
      font-size: 1em;
    }

    input,
    select,
    textarea {
      background-color: #1e1e1e;
      color: #ffffff;
    }

    button {
      background-color: #00ffcc;
      color: #121212;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s ease;
    }

    button:hover {
      background-color: #00cca3;
    }

    .mensagem {
      font-weight: bold;
      margin-top: 10px;
    }

    .sucesso {
      color: #00ff99;
    }

    .erro {
      color: #ff5555;
    }

    #dados {
      background-color: #1e1e1e;
      padding: 15px;
      border-radius: 8px;
      white-space: pre-wrap;
      font-family: monospace;
      max-height: 400px;
      overflow-y: auto;
    }
  </style>
</head>
<body>

  <h2>Registro de Navios</h2>

  <form id="formNavio">
    <input type="text" id="nome" placeholder="Nome do Navio" required />

    <input type="number" id="imo" placeholder="IMO" />

    <input type="number" id="mmsi" placeholder="MMSI" />

    <select id="caracteristica" required>
      <option value="">Selecione a Caracter√≠stica</option>
      <option value="Container">Container</option>
      <option value="Graneleiro">Graneleiro</option>
      <option value="Pesca">Pesca</option>
      <option value="Pesqueiro">Pesqueiro</option>
      <option value="Petroleiro">Petroleiro</option>
      <option value="Tanque">Tanque</option>
    </select>

    <select id="seguro" required>
      <option value="">Possui seguro?</option>
      <option value="Sim">Sim</option>
      <option value="N√£o">N√£o</option>
    </select>

    <select id="classificado" required>
      <option value="">Classifica√ß√£o</option>
      <option value="VOI">VOI</option>
      <option value="COI">COI</option>
      <option value="CCOI">CCOI</option>
    </select>

    <textarea id="observacao" placeholder="Observa√ß√£o..."></textarea>

    <button type="submit">Cadastrar Navio</button>
  </form>

  <div class="mensagem" id="resultado"></div>

  <button onclick="visualizarDados()">üîç Visualizar Banco de Dados</button>
  <div id="dados"></div>

  <script>
    // Substitua essas vari√°veis conforme necess√°rio
    const webhookUrl = 'https://script.google.com/macros/s/AKfycbzhp4Sk_0RDsjiUmDT1u2qf3fB4sQ4gLqGPnfMHa7gboRqf9FHHYm2J1oX7lLNipEQr/exec'; 
    const sheetId = '1dMrjHDh3dhsxSVUCb7h03Yoj1DLqZPn7sNx96EgssI0' /* Coloque aqui o ID da sua planilha */;
    const apiKey = 'AIzaSyC1Uy1QulRVGCitk8N2HBq0WRbGauEzHIs'; // Sua API Key
    const sheetName = 'Cadastro de Navios'; // Altere se mudou o nome da aba

    // Lida com o envio do formul√°rio
    document.getElementById('formNavio').addEventListener('submit', function (e) {
      e.preventDefault();

      const payload = {
        nome: document.getElementById('nome').value,
        imo: document.getElementById('imo').value,
        mmsi: document.getElementById('mmsi').value,
        caracteristica: document.getElementById('caracteristica').value,
        seguro: document.getElementById('seguro').value,
        classificado: document.getElementById('classificado').value,
        observacao: document.getElementById('observacao').value
      };

      fetch(webhookUrl, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      // Mostra mensagem de sucesso
      const resultado = document.getElementById('resultado');
      resultado.textContent = '‚úÖ Adicionado com Sucesso!';
      resultado.className = 'mensagem sucesso';

      this.reset();
    });

    // Fun√ß√£o para carregar dados da planilha
    async function visualizarDados() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetName}?key=${apiKey}`;
      const dadosDiv = document.getElementById('dados');
      dadosDiv.innerHTML = 'üîÑ Carregando dados...';

      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error('Erro ao carregar dados');

        const json = await res.json();
        if (!json.values || json.values.length === 0) {
          dadosDiv.innerHTML = '‚ö†Ô∏è Nenhum dado encontrado.';
          return;
        }

        // Exibe os dados em formato organizado
        let tabela = '<strong>Dados Cadastrados:</strong>\n\n';
        const cabecalho = json.values[0];
        const linhas = json.values.slice(1);

        // Monta uma "tabela" simples
        linhas.forEach((linha) => {
          cabecalho.forEach((campo, i) => {
            tabela += `${campo}: ${linha[i] || '-'}\n`;
          });
          tabela += '\n--------------------\n\n';
        });

        dadosDiv.innerText = tabela;
      } catch (e) {
        dadosDiv.innerHTML = `‚ùå Erro ao carregar dados: ${e.message}`;
      }
    }
  </script>
</body>
</html>
